import{r as a,a as m,j as G}from"./index-aca7c5c9.js";import{V as z,_ as y,P as D,u as P,D as h,M as W,a as I,C as L,b as V}from"./Preload-8de7ac09.js";import{m as _}from"./react-merge-refs.esm-239dbb3c.js";function g(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function x(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),e.push.apply(e,n)}return e}function E(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?x(Object(e),!0).forEach(function(n){g(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):x(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}new z;new z;function U(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}var c=function t(r,e,n){var o=this;U(this,t),g(this,"dot2",function(i,s){return o.x*i+o.y*s}),g(this,"dot3",function(i,s,l){return o.x*i+o.y*s+o.z*l}),this.x=r,this.y=e,this.z=n},k=[new c(1,1,0),new c(-1,1,0),new c(1,-1,0),new c(-1,-1,0),new c(1,0,1),new c(-1,0,1),new c(1,0,-1),new c(-1,0,-1),new c(0,1,1),new c(0,-1,1),new c(0,1,-1),new c(0,-1,-1)],O=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],A=new Array(512),M=new Array(512),B=function(r){r>0&&r<1&&(r*=65536),r=Math.floor(r),r<256&&(r|=r<<8);for(var e=0;e<256;e++){var n;e&1?n=O[e]^r&255:n=O[e]^r>>8&255,A[e]=A[e+256]=n,M[e]=M[e+256]=k[n%12]}};B(0);function N(t){if(typeof t=="number")t=Math.abs(t);else if(typeof t=="string"){var r=t;t=0;for(var e=0;e<r.length;e++)t=(t+(e+1)*(r.charCodeAt(e)%96))%2147483647}return t===0&&(t=311),t}function C(t){var r=N(t);return function(){var e=r*48271%2147483647;return r=e,e/2147483647}}var $=function t(r){var e=this;U(this,t),g(this,"seed",0),g(this,"init",function(n){e.seed=n,e.value=C(n)}),g(this,"value",C(this.seed)),this.init(r)},q=new $(Math.random()),K={radius:1,center:[0,0,0]};function T(t,r){for(var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:q,n=E(E({},K),r),o=n.radius,i=n.center,s=0;s<t.length;s+=3){var l=Math.pow(e.value(),.3333333333333333),u=e.value()*2-1,f=e.value()*2-1,p=e.value()*2-1,b=Math.sqrt(u*u+f*f+p*p);u=l*u/b,f=l*f/b,p=l*p/b,t[s]=u*o+i[0],t[s+1]=f*o+i[1],t[s+2]=p*o+i[2]}return t}class H extends D{constructor(r){super(r),this.onBeforeCompile=(e,n)=>{const{isWebGL2:o}=n.capabilities;e.fragmentShader=e.fragmentShader.replace("#include <output_fragment>",`
        ${o?"#include <output_fragment>":`#extension GL_OES_standard_derivatives : enable
#include <output_fragment>`}
      vec2 cxy = 2.0 * gl_PointCoord - 1.0;
      float r = dot(cxy, cxy);
      float delta = fwidth(r);     
      float mask = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);
      gl_FragColor = vec4(gl_FragColor.rgb, mask * gl_FragColor.a );
      #include <tonemapping_fragment>
      #include <encodings_fragment>
      `)}}}const J=a.forwardRef((t,r)=>{const[e]=a.useState(()=>new H(null));return a.createElement("primitive",y({},t,{object:e,ref:r,attach:"material"}))});let d,v;const Q=a.createContext(null),R=new W,j=new I,X=a.forwardRef(({children:t,range:r,limit:e=1e3,...n},o)=>{const i=a.useRef(null),[s,l]=a.useState([]),[[u,f,p]]=a.useState(()=>[new Float32Array(e*3),Float32Array.from({length:e*3},()=>1),Float32Array.from({length:e},()=>1)]);a.useEffect(()=>{i.current.geometry.attributes.position.needsUpdate=!0}),P(()=>{for(i.current.updateMatrix(),i.current.updateMatrixWorld(),R.copy(i.current.matrixWorld).invert(),i.current.geometry.drawRange.count=Math.min(e,r!==void 0?r:e,s.length),d=0;d<s.length;d++)v=s[d].current,v.getWorldPosition(j).applyMatrix4(R),j.toArray(u,d*3),i.current.geometry.attributes.position.needsUpdate=!0,v.matrixWorldNeedsUpdate=!0,v.color.toArray(f,d*3),i.current.geometry.attributes.color.needsUpdate=!0,p.set([v.size],d),i.current.geometry.attributes.size.needsUpdate=!0});const b=a.useMemo(()=>({getParent:()=>i,subscribe:S=>(l(w=>[...w,S]),()=>l(w=>w.filter(F=>F.current!==S.current)))}),[]);return a.createElement("points",y({userData:{instances:s},matrixAutoUpdate:!1,ref:_([o,i]),raycast:()=>null},n),a.createElement("bufferGeometry",null,a.createElement("bufferAttribute",{attach:"attributes-position",count:u.length/3,array:u,itemSize:3,usage:h}),a.createElement("bufferAttribute",{attach:"attributes-color",count:f.length/3,array:f,itemSize:3,usage:h}),a.createElement("bufferAttribute",{attach:"attributes-size",count:p.length,array:p,itemSize:1,usage:h})),a.createElement(Q.Provider,{value:b},t))}),Y=a.forwardRef(({children:t,positions:r,colors:e,sizes:n,stride:o=3,...i},s)=>{const l=a.useRef(null);return P(()=>{const u=l.current.geometry.attributes;u.position.needsUpdate=!0,e&&(u.color.needsUpdate=!0),n&&(u.size.needsUpdate=!0)}),a.createElement("points",y({ref:_([s,l])},i),a.createElement("bufferGeometry",null,a.createElement("bufferAttribute",{attach:"attributes-position",count:r.length/o,array:r,itemSize:o,usage:h}),e&&a.createElement("bufferAttribute",{attach:"attributes-color",count:e.length/o,array:e,itemSize:3,usage:h}),n&&a.createElement("bufferAttribute",{attach:"attributes-size",count:n.length/o,array:n,itemSize:1,usage:h})),t)}),Z=a.forwardRef((t,r)=>t.positions instanceof Float32Array?a.createElement(Y,y({},t,{ref:r})):a.createElement(X,y({},t,{ref:r}))),ee=t=>{const r=a.useRef(),e=a.useMemo(()=>T(new Float32Array(5e3),{radius:1.2}),[]);return P((n,o)=>{r.current.rotation.x-=o/10,r.current.rotation.y-=o/15}),m("group",{rotation:[0,0,Math.PI/4],children:m(Z,{ref:r,positions:e,stride:3,frustumCulled:!0,...t,children:m(J,{transparent:!0,color:"#f272c8",size:.002,sizeAttenuation:!0,depthWrite:!1})})})},ae=()=>m("div",{className:"w-full h-auto absolute inset-0 z-[-1]",children:G(L,{camera:{position:[0,0,1]},shadows:!0,dpr:[1,2],gl:{antialias:!0},children:[m(a.Suspense,{fallback:m("div",{children:"Loading..."}),children:m(ee,{})}),m(V,{all:!0})]})});export{ae as default};
